Attribute VB_Name = "Module1"
Option Explicit
    Public nowfile As String
    Public oldfile As String
    Dim co As Integer
    Dim stco As Integer
    Dim stco2 As Integer
    Public stflag As Boolean
    Dim colcount As Integer
    Dim wb As Workbook
    Dim ws As Worksheet
    Public twb As Workbook
    Dim tws As Worksheet
    Dim ptcount As Integer
    Dim ptnum As Integer
    Dim stnum As Integer
    Dim pt As Integer
    Dim ptco As Integer
    Dim ubo As Integer
    Dim stws As Worksheet
    Dim modeformat2() As Variant
    Dim diflist(2000, 9) As Variant
    Dim difcount As Integer
    Dim ptstname() As Variant
    Dim ptstreuse() As Variant
    Dim stcount As Integer
    Dim program_new As String
    Dim program_old As String
    
    Type data
        ptstnum As Variant
        info As Variant
        oldptstnum As Variant
        oldinfo As Variant
    End Type
    
    Public all As data
    
Sub extract()
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim ptnum As Integer
    Dim stnum As Integer
    Dim j As Integer
    Dim k As Integer
    Dim pt As Integer
    Dim st As Integer
    Dim count As Integer
    Dim rwend As Integer
    Dim rw As Integer
    Dim info() As Variant
    Dim sheetsname() As Variant
    Dim ptname As String
    Dim abno_rw As Integer
    Dim abno_rw2 As Integer
    
'-----------------------------------分割処理--------------------------------------------
        
'        Application.ScreenUpdating = False
        
        Set wb = Workbooks.Open(nowfile)
        Set ws = wb.Sheets(1)
        rwend = ws.Cells(ws.Rows.count, 1).End(xlUp).Row

        j = 1
        k = 0
        ptnum = 1
        stnum = 1
        count = 0

        ws.Cells.Replace What:="=-dV/dt dV(値)", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt dV(制御条件)", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt dt", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt 遅延時間", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="#NAME?", Replacement:="", LookAt:=xlWhole
        co = WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ﾊﾟﾀｰﾝ *") + WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ｽﾃｯﾌﾟ *")
        stco = WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ｽﾃｯﾌﾟ *")
        stco2 = stco
        ReDim sheetsname(co) As Variant
        ReDim info(co) As Variant
        ReDim ptstname(co, 1) As Variant
        ReDim ptstreuse(stco - 1, 4) As Variant
        stcount = 0
        program_new = ws.Cells(4, 7)
'------------------------パターンステップ区切りで配列に格納---------------------------------------
        Do While j <= rwend
            If j = rwend Then
                info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j, 63))
                sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum
                If ptnum < 10 And stnum < 10 Then
                    ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                    ptstreuse(stcount, 1) = ptname
                    ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                    ptstreuse(stcount, 3) = info(k)(7, 1)
                    ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                    ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                    
                ElseIf ptnum >= 10 And stnum < 10 Then
                    ptstreuse(stcount, 0) = "Ptn" & ptnum
                    ptstreuse(stcount, 1) = ptname
                    ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                    ptstreuse(stcount, 3) = info(k)(7, 1)
                    ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                    ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                    
                ElseIf ptnum < 10 And stnum >= 10 Then
                    ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                    ptstreuse(stcount, 1) = ptname
                    ptstreuse(stcount, 2) = "Stp" & stnum
                    ptstreuse(stcount, 3) = info(k)(7, 1)
                    ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                    ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                
                ElseIf ptnum >= 10 And stnum >= 10 Then
                    ptstreuse(stcount, 0) = "Ptn" & ptnum
                    ptstreuse(stcount, 1) = ptname
                    ptstreuse(stcount, 2) = "Stp" & stnum
                    ptstreuse(stcount, 3) = info(k)(7, 1)
                    ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                    ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                    
                End If
                
                Exit Do
                
            End If
            
            pt = InStr(ws.Cells(j, 1), "********** ﾊﾟﾀｰﾝ")
            st = InStr(ws.Cells(j, 1), "********** ｽﾃｯﾌﾟ")
            abno_rw = InStr(ws.Cells(j, 1), "********** 異常上下限設定")
            
            If abno_rw <> 0 Then
                abno_rw2 = j
                
            End If
            
            If pt <> 0 Then
                If count = 0 Then
                    info(k) = ws.Range(ws.Cells(abno_rw2, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "異常上下限"
                    k = k + 1
                    count = 1
                    
                Else
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum

                    If ptnum < 10 And stnum < 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                        
                    ElseIf ptnum >= 10 And stnum < 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                        
                    ElseIf ptnum < 10 And stnum >= 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                        
                    ElseIf ptnum >= 10 And stnum >= 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                        
                        
                    End If
                    
                    stcount = stcount + 1
                    stnum = 1
                    ptnum = ptnum + 1
                    k = k + 1
                    count = 1
                    
                    
                End If
                
                rw = j
                
            
            ElseIf st <> 0 Then
                If count = 1 Then
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum
                    ptname = info(k)(4, 1)
                    If ptnum < 10 Then
                        ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                        
                    Else
                        ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                        
                    End If
                    k = k + 1
                    count = 2
                    
                Else
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum
                    
                    If ptnum < 10 And stnum < 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                        
                    ElseIf ptnum >= 10 And stnum < 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & "0" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & "0" & stnum & "_" & info(k)(7, 1)
                        
                    ElseIf ptnum < 10 And stnum >= 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & "0" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & "0" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                    
                    ElseIf ptnum >= 10 And stnum >= 10 Then
                        ptstreuse(stcount, 0) = "Ptn" & ptnum
                        ptstreuse(stcount, 1) = ptname
                        ptstreuse(stcount, 2) = "Stp" & stnum
                        ptstreuse(stcount, 3) = info(k)(7, 1)
                        ptstname(k, 0) = "Ptn" & ptnum & "_" & ptname
                        ptstname(k, 1) = "Stp" & stnum & "_" & info(k)(7, 1)
                        
                    End If

                    stnum = stnum + 1
                    stcount = stcount + 1
                    k = k + 1
                
                End If
                
                rw = j
                
            End If

                    
            j = j + 1
                    
        Loop
'--------------------------------------------------------------------------------------------
        
        wb.Close SaveChanges:=False
        all.info = info
        all.ptstnum = sheetsname
        
End Sub
Sub extract2()
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim ptnum As Integer
    Dim stnum As Integer
    Dim j As Integer
    Dim k As Integer
    Dim pt As Integer
    Dim st As Integer
    Dim count As Integer
    Dim rwend As Integer
    Dim rw As Integer
    Dim info() As Variant
    Dim sheetsname() As Variant
    Dim flag As Boolean
    Dim abno_rw As Integer
    Dim abno_rw2 As Integer
    '-----------------------------------分割処理--------------------------------------------
        
'        Application.ScreenUpdating = False
        
        Set wb = Workbooks.Open(oldfile)
        Set ws = wb.Sheets(1)
        rwend = ws.Cells(ws.Rows.count, 1).End(xlUp).Row

        j = 1
        k = 0
        ptnum = 1
        stnum = 1
        count = 0
        stflag = False

        ws.Cells.Replace What:="=-dV/dt dV(値)", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt dV(制御条件)", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt dt", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="=-dV/dt 遅延時間", Replacement:="", LookAt:=xlWhole
        ws.Cells.Replace What:="#NAME?", Replacement:="", LookAt:=xlWhole
        co = WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ﾊﾟﾀｰﾝ *") + WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ｽﾃｯﾌﾟ *")
        stco = WorksheetFunction.CountIf(ws.Range(ws.Cells(1, 1), ws.Cells(rwend, 1)), "********** ｽﾃｯﾌﾟ *")
        If stco <> stco2 Then
            stflag = True
            MsgBox "シート数が違います"
            Exit Sub
        End If
        ReDim sheetsname(co) As Variant
        ReDim info(co) As Variant
        flag = False
        stcount = 0
        program_old = ws.Cells(4, 7)
'------------------------パターンステップ区切りで配列に格納---------------------------------------
        Do While j <= rwend
            If j = rwend Then
                info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j, 63))
                sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum
                k = k + 1
                flag = True
                
                
            End If
            
            pt = InStr(ws.Cells(j, 1), "********** ﾊﾟﾀｰﾝ")
            st = InStr(ws.Cells(j, 1), "********** ｽﾃｯﾌﾟ")
            abno_rw = InStr(ws.Cells(j, 1), "********** 異常上下限設定")
            
            If abno_rw <> 0 Then
                abno_rw2 = j
                
            End If
            
            If pt <> 0 And j <> rwend Then
                If count = 0 Then
                    info(k) = ws.Range(ws.Cells(abno_rw2, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "異常上下限"
                    k = k + 1
                    count = 1
                    flag = True
                    
                Else
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum
                    stnum = 1
                    ptnum = ptnum + 1
                    k = k + 1
                    count = 1
                    flag = True
                    
                    
                End If
                
                rw = j
                
            
            ElseIf st <> 0 Then
                If count = 1 Then
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum
                    k = k + 1
                    count = 2
                    flag = True
                    
                Else
                    info(k) = ws.Range(ws.Cells(rw, 1), ws.Cells(j - 1, 63))
                    sheetsname(k) = "Ptn" & ptnum & "-Stp" & stnum
                    stnum = stnum + 1
                    k = k + 1
                    flag = True
                
                End If
                
                rw = j
                
            End If
            
            If flag = True Then
                If UBound(info(k - 1)) < UBound(all.info(k - 1)) Then
                    Dim infocorrection() As Variant
                    ReDim infocorrection(UBound(all.info(k - 1)), 63) As Variant
                    Dim rwcorrection As Integer
                    Dim colcorrection As Variant
                    
                    rwcorrection = 1
                    Do While rwcorrection <= UBound(info(k - 1))
                        colcorrection = 1
                        Do While colcorrection <= 63
                            infocorrection(rwcorrection, colcorrection) = info(k - 1)(rwcorrection, colcorrection)
                            
                            colcorrection = colcorrection + 1
                            
                        Loop
                        
                        rwcorrection = rwcorrection + 1
                    Loop
                    
                    info(k - 1) = infocorrection
                    
                End If
    
                flag = False
                
            End If
                    
            j = j + 1
                    
        Loop
'--------------------------------------------------------------------------------------------
        
        wb.Close SaveChanges:=False
        all.oldinfo = info
        all.oldptstnum = sheetsname
        
        
        
End Sub

Sub main2()
    Dim ptnum2 As String
    Dim i As Integer
    Dim j As Integer
    Dim name As String
    Dim name2 As String
    Dim wsdel As Worksheet
    Dim ptcolor2() As Variant
    Dim stcolor2() As Variant
    Dim colorcount As Integer
    Dim ptcount As Integer
    Dim colcount2 As Integer
    Dim ptinfo() As Variant
    Dim count As Integer
    Dim count2 As Integer
    Dim ptstformat() As Variant
    Dim wid As Integer
    Dim wid2 As Integer
    Dim oldptnum As Integer
    ReDim modeformat2(38, 0) As Variant
    
    Set twb = ThisWorkbook
    Set tws = twb.Sheets(2)
    difcount = 0
    
    Call abno2
    
    ReDim ptinfo(27, stco)
    ptcount = 1
    count = 0
    count2 = 0
    i = 1
    ptnum = 0
    colcount2 = 4
    colorcount = 0
    ReDim ptcolor2(stco)
    ReDim stcolor2(stco)
    
    '----------パターンステップの情報取得--------------------
    Do While i <= co
        If InStr(all.ptstnum(i), "-") = 0 Then
            ptnum = ptnum + 1
            Call pt2(i, ptcolor2, colcount2, ptinfo, count)
            count2 = count
            stnum = 1
            
        Else
            If stnum = 1 Then
                Call st2(i, stcolor2, colorcount, colcount2, ptinfo, count)
                
            Else
                Call st2(i, stcolor2, colorcount, colcount2, ptinfo, count)
                j = 0
                Do While j <= 13
                    ptinfo(j, count) = ptinfo(j, count2)
                    j = j + 1
                    
                Loop
                
            End If
            
            count = count + 1
                
            If i = co Then
                Exit Do
                
            Else
                stnum = stnum + 1
                colorcount = colorcount + 1
                colcount2 = colcount2 + 1
                
            End If

        End If
        
        i = i + 1
            
    Loop
    
    '------------------------------------------------
    
    '----------各セルの書式格納---------------
    ReDim ptstformat(27, colcount2) As Variant
    i = 0
    Do While i <= colcount2
        j = 0
        Do While j <= 27
            ptstformat(j, i) = tws.Cells(j + 1, 4).NumberFormat
            
            j = j + 1
            
        Loop
        
        i = i + 1
        
    Loop
    
    i = 0
    Do While i <= 38
        modeformat2(i, 0) = tws.Cells(i + 29, 4).NumberFormat
        
        i = i + 1
        
    Loop
    '----------------------------------------------------
    
    tws.Range(tws.Cells(1, 4), tws.Cells(28, colcount2)).NumberFormat = ptstformat
    tws.Range(tws.Cells(1, 4), tws.Cells(28, colcount2)).HorizontalAlignment = xlCenter
    tws.Range(tws.Cells(1, 4), tws.Cells(28, colcount2)) = ptinfo
    
    i = 1
    colcount = 4
    ptnum = 0
    stnum = 1
    oldptnum = 0
    pt = 1
    stcount = 0
  '--------------モード情報の取得と既存プログラムと比較--------------
    Do While i <= co
        If InStr(all.ptstnum(i), "-") = 0 Then
            ptnum = ptnum + 1
            ptcount = colcount
        
        Else
            If pt > 5 Then
                tws.Range("D:D").Delete
            End If
            
            Call mode2(i, ptcolor2, stcolor2, ptcount, ptinfo, oldptnum)
            stnum = stnum + 1
            colcount = colcount + 1
            pt = pt + 1
            oldptnum = ptnum
            
        End If
        
        i = i + 1
        
    Loop
    
    '-------------------------------------------------------------------
    
    Application.DisplayAlerts = False
    
    For Each wsdel In twb.Worksheets
        If wsdel.name = "FM" Then
            wsdel.Delete
        End If
            
    Next wsdel
    
    i = 0
    Dim flag As Boolean
    Dim ptrow As Integer
    
    flag = False
    
    Do While i <= difcount
        j = 0
        diflist(i, 7) = diflist(i, 1) & diflist(i, 2) & diflist(i, 3)
        diflist(i, 8) = diflist(i, 1) & diflist(i, 2)
        Do While j <= UBound(ptstreuse)
            If diflist(i, 8) = ptstreuse(j, 0) & "_" & ptstreuse(j, 1) & ptstreuse(j, 2) & "_" & ptstreuse(j, 3) And ptstreuse(j, 4) <> "" Then
                diflist(i, 9) = ptstreuse(j, 4)
                Exit Do
                
            End If
                
            j = j + 1
                
        Loop
        
        If InStr(diflist(i, 1), "Ptn") <> 0 And flag = False Then
            ptrow = i
            flag = True
        End If
        
        i = i + 1
        
    Loop
        
    twb.Sheets(1).Range(twb.Sheets(1).Cells(2, 5), twb.Sheets(1).Cells(UBound(diflist) + 2, 14)) = diflist
    twb.Sheets(1).Range(twb.Sheets(1).Cells(2, 5), twb.Sheets(1).Cells(UBound(diflist) + 2, 11)).HorizontalAlignment = xlLeft
    twb.Sheets(1).Range("E:K").EntireColumn.AutoFit
    twb.Sheets(1).Range(twb.Sheets(1).Cells(1, 5), twb.Sheets(1).Cells(difcount + 1, 11)).Borders.LineStyle = xlContinuous
    twb.Sheets(1).Range(twb.Sheets(1).Cells(2, 6), twb.Sheets(1).Cells(twb.Sheets(1).Cells(Rows.count, 5).End(xlUp).Row, 11)).FormatConditions.Add(Type:=xlBlanksCondition).Interior.Color = RGB(166, 166, 166)
    twb.Sheets(1).Range(twb.Sheets(1).Cells(2, 9), twb.Sheets(1).Cells(twb.Sheets(1).Cells(Rows.count, 5).End(xlUp).Row, 9)).FormatConditions.Add(Type:=xlCellValue, Operator:=xlEqual, Formula1:="モード").Interior.Color = RGB(255, 192, 0)
    With twb.Sheets(1)
        .Sort.SortFields.Add Key:=.Range("L2"), Order:=xlAscending
        .Sort.SetRange twb.Sheets(1).Range(twb.Sheets(1).Cells(ptrow + 2, 6), twb.Sheets(1).Cells(twb.Sheets(1).Cells(Rows.count, 5).End(xlUp).Row, 14))
        .Sort.Header = xlYes
        .Sort.Apply
    End With
    twb.Sheets(1).Range("L:M").Delete
    
    twb.Sheets(1).Range(twb.Sheets(1).Cells(2, 6), twb.Sheets(1).Cells(twb.Sheets(1).Cells(Rows.count, 5).End(xlUp).Row, 11)).FormatConditions.Add(Type:=xlExpression, Formula1:="=COUNTIF($L2,""*reuse"")").Interior.Color = RGB(155, 194, 230)
    
    twb.Sheets(1).Select
    twb.Sheets(1).Range("A1").Select
    pt = Len(nowfile)
    name = program_new
    i = InStrRev(name, "\")
    name = Mid(name, i + 1)
    i = InStrRev(nowfile, "プログラム")
    name2 = program_old
    j = InStrRev(name2, "\")
    name2 = Mid(name2, j + 1)
    nowfile = Left(nowfile, i - 1)
    i = InStrRev(nowfile, "\")
    nowfile = Left(nowfile, i)
    nowfile = Left(nowfile, pt - 4) & "チェック" & "\" & name & "⇔" & name2 & ".xlsx"
End Sub

Sub abno2()
'異常上下限の取得(ok)
    Dim i As Integer
    Dim j As Integer
    Dim abnormal(5, 1) As Variant
    Dim flag As Boolean
    
    i = 1
    ubo = UBound(all.info(0))
    flag = False
    
    Do While i <= ubo

        j = 1

        Do While j <= 63
            Select Case all.info(0)(i, j)
                Case "電圧上限"
                    abnormal(0, 0) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("B5").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B5").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            twb.Sheets(1).Range("B5").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B5").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                            
                        End If
                            
                    End If
                Case "電圧下限"
                    abnormal(0, 1) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("C5").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C5").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            twb.Sheets(1).Range("C5").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C5").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If

                    End If
                Case "電流上限"
                    abnormal(1, 0) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("B6").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B6").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            twb.Sheets(1).Range("B6").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B6").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If
                    End If
                Case "電流下限"
                    abnormal(1, 1) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("C6").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C6").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            twb.Sheets(1).Range("C6").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C6").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If
                    End If
                Case "容量上限"
                    abnormal(2, 0) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("B7").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B7").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("B7").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B7").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If
                    End If
                Case "容量下限"
                    abnormal(2, 1) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("C7").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C7").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            twb.Sheets(1).Range("C7").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C7").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                        End If
                    End If
                Case "電力量上限"
                    abnormal(3, 0) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("B8").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B8").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("B8").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B8").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If
                    End If
                Case "電力量下限"
                    abnormal(3, 1) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("C8").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C8").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("C8").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C8").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If

                    End If
                Case "ｾﾙ温度上限"
                    abnormal(4, 0) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("B9").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B9").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("B9").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B9").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If

                    End If
                Case "ｾﾙ温度下限"
                    abnormal(4, 1) = all.info(0)(i + 1, j)
                    If all.info(0)(i + 1, j) <> all.oldinfo(0)(i + 1, j) Then
                        If flag = False Then
                            twb.Sheets(1).Range("C9").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C9").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("C9").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("C9").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If

                    End If
                Case "周囲温度上限"
                    If all.info(0)(i + 1, j) >= 100 Then
                        abnormal(5, 0) = "-"
                    Else
                        abnormal(5, 0) = all.info(0)(i + 1, j)
                    End If
                    
                    If all.info(0)(i + 1, j) < 100 Or all.oldinfo(0)(i + 1, j) < 100 Then
                        If flag = False Then
                            twb.Sheets(1).Range("B10").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B10").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            twb.Sheets(1).Tab.ColorIndex = 3
                            flag = True
                        Else
                            twb.Sheets(1).Range("B10").Interior.Color = RGB(48, 84, 150)
                            twb.Sheets(1).Range("B10").Font.Color = RGB(255, 255, 255)
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = "異常上下限"
                            diflist(difcount, 4) = all.info(0)(i, j)
                            diflist(difcount, 5) = all.info(0)(i + 1, j)
                            diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                            difcount = difcount + 1
                            
                        End If

                    End If
                Case "周囲温度下限"
                    If all.info(0)(i + 1, j) = -50 Or all.info(0)(i + 1, j) = -60 Then
                        abnormal(5, 1) = "-"
                    Else
                        abnormal(5, 1) = all.info(0)(i + 1, j)
                    End If
                    
                    If all.info(0)(i + 1, j) <> -50 And all.info(0)(i + 1, j) <> -60 Then
                        If all.oldinfo(0)(i + 1, j) <> -50 And all.info(0)(i + 1, j) <> -60 Then
                            If flag = False Then
                                twb.Sheets(1).Range("C10").Interior.Color = RGB(48, 84, 150)
                                twb.Sheets(1).Range("C10").Font.Color = RGB(255, 255, 255)
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = "異常上下限"
                                diflist(difcount, 4) = all.info(0)(i, j)
                                diflist(difcount, 5) = all.info(0)(i + 1, j)
                                diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                                difcount = difcount + 1
                                twb.Sheets(1).Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                twb.Sheets(1).Range("C10").Interior.Color = RGB(48, 84, 150)
                                twb.Sheets(1).Range("C10").Font.Color = RGB(255, 255, 255)
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = "異常上下限"
                                diflist(difcount, 4) = all.info(0)(i, j)
                                diflist(difcount, 5) = all.info(0)(i + 1, j)
                                diflist(difcount, 6) = all.oldinfo(0)(i + 1, j)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If

                    End If

            End Select

            j = j + 1

        Loop

        i = i + 1

    Loop

    twb.Sheets(1).Range(twb.Sheets(1).Cells(5, 2), twb.Sheets(1).Cells(10, 3)) = abnormal

End Sub

Sub pt2(i As Integer, ptcolor2 As Variant, colcount2 As Integer, ptinfo As Variant, count As Integer)
    'パターンの情報を取得して入力(ok)
    Dim j As Integer
    Dim k As Integer
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim wscount As Integer
    Dim rw As Integer
    Dim ptcolor(13, 1) As Variant

    rw = 2
    
    flag = False
    flag2 = False
    
    ptco = Len(all.ptstnum(i))
    pt = InStr(all.ptstnum(i), "Ptn")
    ptinfo(0, count) = Right(all.ptstnum(i), ptco - pt - 2)
    j = 1
    ubo = UBound(all.info(i))
    
    Do While j <= ubo
        k = 1
        Do While k <= 63
            Select Case all.info(i)(j, k)
                Case "ﾊﾟﾀｰﾝﾌｧｲﾙ名"
                    If flag = False Then
                        ptinfo(1, count) = all.info(i)(j + 2, k)
                        flag = True
                        If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                            ptcolor(1, 1) = "dif"
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 2, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                Case "コメント"
                    If flag2 = False Then
                        ptinfo(2, count) = all.info(i)(j + 2, k)
                        If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                            ptcolor(2, 1) = "dif"
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 2, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                            difcount = difcount + 1
                            
                        End If
                        flag2 = True
                        
                    End If
                        
                Case "繰り返し回数"
                    ptinfo(3, count) = all.info(i)(j + 1, k)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                        ptcolor(3, 1) = "dif"
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstname(i, 0)
                        diflist(difcount, 4) = all.info(i)(j, k)
                        diflist(difcount, 5) = all.info(i)(j + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                        difcount = difcount + 1
                            
                    End If
                    
                Case "総累積時間(値)"
                    ptinfo(4, count) = all.info(i)(j + 1, k) / 3600 / 24
                    ptcolor(4, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(4, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                                                      
                        End If
                        
                                
                    End If
                    
                Case "電圧上限(値)"
                    ptinfo(5, count) = all.info(i)(j + 1, k)
                    ptcolor(5, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(5, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                        
                    
                Case "電圧下限(値)"
                    ptinfo(6, count) = all.info(i)(j + 1, k)
                    ptcolor(6, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(6, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "電流上限(値)"
                    ptinfo(7, count) = all.info(i)(j + 1, k)
                    ptcolor(7, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(7, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "電力上限(値)"
                    ptinfo(8, count) = all.info(i)(j + 1, k)
                    ptcolor(8, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(8, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "試験累積容量上限(値)"
                    ptinfo(9, count) = all.info(i)(j + 1, k)
                    ptcolor(9, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(9, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "試験累積容量下限(値)"
                    ptinfo(10, count) = all.info(i)(j + 1, k)
                    ptcolor(10, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(10, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "試験充電累積容量(値)"
                    ptinfo(11, count) = all.info(i)(j + 1, k)
                    ptcolor(11, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(11, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "試験放電累積容量(値)"
                    ptinfo(12, count) = all.info(i)(j + 1, k)
                    ptcolor(12, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        ptcolor(12, 1) = "dif"
                        
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If
                    End If
                    
                Case "ｾﾙ温度"
                    If all.info(i)(j + 1, k) = "上限(値)" Then
                        ptcolor(13, 0) = all.info(i)(j + 2, k + 1)
                        If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Or all.info(i)(j + 2, k + 1) <> all.oldinfo(i)(j + 2, k + 1) Then
                            ptcolor(13, 1) = "dif"
                            
                            If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstname(i, 0)
                                diflist(difcount, 4) = all.info(i)(j, k)
                                diflist(difcount, 5) = all.info(i)(j + 2, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                                difcount = difcount + 1
                                
                            End If
                        
                            If all.info(i)(j + 2, k + 1) <> all.oldinfo(i)(j + 2, k + 1) Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstname(i, 0)
                                diflist(difcount, 4) = all.info(i)(j, k)
                                diflist(difcount, 5) = all.info(i)(j + 2, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + 2, k + 1)
                                difcount = difcount + 1
                                
                            End If
                        End If
                        If all.info(i)(j + 2, k) > 500 Then
                            ptinfo(13, count) = "-"
                            
                        Else
                           ptinfo(13, count) = all.info(i)(j + 2, k)
                           
                        End If
                        
                    End If
                    
            End Select
            
            k = k + 1
        Loop
        
        j = j + 1
    Loop

    ptcolor2(ptnum - 1) = ptcolor


End Sub

Sub st2(i As Integer, stcolor2 As Variant, colorcount As Integer, colcount2 As Integer, ptinfo As Variant, count As Integer)
    'ステップの情報を取得して入力()
    Dim j As Integer
    Dim k As Integer
    Dim stinfo(13, 0) As Variant
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim flag3 As Boolean
    Dim flag4 As Boolean
    Dim rw As Integer
    Dim stcolor(13, 1) As Variant
    
    rw = 16
    
    flag = False
    flag2 = False
    flag3 = False
    flag4 = False
    
    For i = 1 To co
        If all.ptstnum(i) = "Ptn" & ptnum & "-Stp" & stnum Then
            Exit For
            
        End If
        
    Next i
    
    ptinfo(14, count) = stnum
    
    j = 1
    ubo = UBound(all.info(i))
    
    Do While j <= ubo
        k = 1
        Do While k <= 63
            Select Case all.info(i)(j, k)
                Case "パターン名称"
                    If flag = False Then
                        ptinfo(15, count) = all.info(i)(j + 2, k)
                        If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                            stcolor(1, 1) = "dif"
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 2, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        flag = True
                        
                    End If
                    
                Case "コメント"
                    If flag2 = False Then
                        ptinfo(16, count) = all.info(i)(j + 2, k)
                        If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                            stcolor(2, 1) = "dif"
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 2, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                            difcount = difcount + 1
                            
                        End If
                        flag2 = True
                        
                    End If
                        
                Case "繰り返し回数"
                    ptinfo(17, count) = all.info(i)(j + 1, k)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                        stcolor(3, 1) = "dif"
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstname(i, 0)
                        diflist(difcount, 2) = ptstname(i, 1)
                        diflist(difcount, 4) = all.info(i)(j, k)
                        diflist(difcount, 5) = all.info(i)(j + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                Case "ｽﾃｯﾌﾟ累積時間(値)"
                    ptinfo(18, count) = all.info(i)(j + 1, k) / 3600 / 24
                    stcolor(4, 0) = all.info(i)(j + 1, k + 1)
                    If all.oldinfo(i)(j + 1, k) = 3599999.99 And all.info(i)(j + 1, k) = 3599999.9 Then
                       all.oldinfo(i)(j + 1, k) = 3599999.9
                       
                    ElseIf all.oldinfo(i)(j + 1, k) = 3599999.9 And all.info(i)(j + 1, k) = 3599999.99 Then
                       all.oldinfo(i)(j + 1, k) = 3599999.99
                       
                    End If
                    
                    
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(4, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                        
                Case "電圧上限(値)"
                    ptinfo(19, count) = all.info(i)(j + 1, k)
                    stcolor(5, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(5, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "電圧下限(値)"
                    ptinfo(20, count) = all.info(i)(j + 1, k)
                    stcolor(6, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(6, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "電流上限(値)"
                    ptinfo(21, count) = all.info(i)(j + 1, k)
                    stcolor(7, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(7, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "電力上限(値)"
                    ptinfo(22, count) = all.info(i)(j + 1, k)
                    stcolor(8, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(8, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "ｽﾃｯﾌﾟ累積容量上限(値)"
                    ptinfo(23, count) = all.info(i)(j + 1, k)
                    stcolor(9, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(9, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "ｽﾃｯﾌﾟ累積容量下限(値)"
                    ptinfo(24, count) = all.info(i)(j + 1, k)
                    stcolor(10, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(10, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "ｽﾃｯﾌﾟ充電累積容量(値)"
                    ptinfo(25, count) = all.info(i)(j + 1, k)
                    stcolor(11, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(11, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "ｽﾃｯﾌﾟ放電累積容量(値)"
                    ptinfo(26, count) = all.info(i)(j + 1, k)
                    stcolor(12, 0) = all.info(i)(j + 1, k + 1)
                    If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Or all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                        stcolor(12, 1) = "dif"
                        If all.info(i)(j + 1, k) <> all.oldinfo(i)(j + 1, k) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                        If all.info(i)(j + 1, k + 1) <> all.oldinfo(i)(j + 1, k + 1) Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstname(i, 0)
                            diflist(difcount, 2) = ptstname(i, 1)
                            diflist(difcount, 4) = all.info(i)(j, k)
                            diflist(difcount, 5) = all.info(i)(j + 1, k + 1)
                            diflist(difcount, 6) = all.oldinfo(i)(j + 1, k + 1)
                            difcount = difcount + 1
                            
                        End If

                            
                    End If
                    
                Case "ｾﾙ温度"
                    If all.info(i)(j + 1, k) = "上限(値)" Then
                        If flag3 = False Then
                        
                            If all.info(i)(j + 2, k) > 500 Then
                                ptinfo(27, count) = "-"
                                
                            Else
                               ptinfo(27, count) = all.info(i)(j + 2, k)
                               
                            End If
                            
                            flag3 = True
                            
                            stcolor(13, 0) = all.info(i)(j + 2, k + 1)
                            If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Or all.info(i)(j + 2, k + 1) <> all.oldinfo(i)(j + 2, k + 1) Then
                                stcolor(13, 1) = "dif"
                                If all.info(i)(j + 2, k) <> all.oldinfo(i)(j + 2, k) Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstname(i, 0)
                                    diflist(difcount, 2) = ptstname(i, 1)
                                    diflist(difcount, 4) = all.info(i)(j, k)
                                    diflist(difcount, 5) = all.info(i)(j + 2, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + 2, k)
                                    difcount = difcount + 1
                                    
                                End If
                        
                                If all.info(i)(j + 2, k + 1) <> all.oldinfo(i)(j + 2, k + 1) Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstname(i, 0)
                                    diflist(difcount, 2) = ptstname(i, 1)
                                    diflist(difcount, 4) = all.info(i)(j, k)
                                    diflist(difcount, 5) = all.info(i)(j + 2, k + 1)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + 2, k + 1)
                                    difcount = difcount + 1
                                    
                                End If

                            
                            End If
                            
                        End If
                        
                    End If
                    
                Case "********** ﾓｰﾄﾞ **********"
                    flag4 = True
                    
                End Select
            
            If flag4 = True Then
                Exit Do
            End If
            
            k = k + 1
        Loop
        If flag4 = True Then
            Exit Do
            
        End If
        j = j + 1
    Loop
        
    stcolor2(colorcount) = stcolor
    
    
End Sub


Sub mode2(i As Integer, ptcolor2 As Variant, stcolor2 As Variant, ptcount As Integer, ptinfo As Variant, oldptnum As Integer)
    'モード情報の取得と入力
    Dim j As Integer
    Dim col As Integer
    Dim k As Integer
    Dim l As Integer
    Dim flag As Boolean
    Dim modeinfo() As Variant
    Dim modecount As Integer
    Dim rwcount As Integer
    Dim wscount As Integer
    Dim modeformat() As Variant
    Dim modeoldinfo()
    
    wscount = twb.Sheets.count
    twb.Sheets("FM").Copy After:=twb.Sheets(wscount)
    ActiveSheet.name = all.ptstnum(i)
    Set stws = twb.Sheets(all.ptstnum(i))
    
    j = 1
    flag = False
    ubo = UBound(all.info(i))
     
    Do While j <= ubo
        col = 1
        Do While col <= 63
            If all.info(i)(j, col) = "モード" Then
                flag = True
                Exit Do
                
            ElseIf all.info(i)(j, col) = "有効ﾊﾟﾀｰﾝ数" Then
                ptco = all.info(i)(j + 1, col)
                            
            End If
                        
            col = col + 1
                        
        Loop
                    
        If flag = True Then
            Exit Do
                        
        End If
        
        j = j + 1
                    
    Loop
    
    l = 0
    flag = False
    
    If pt <= 5 Then
        stws.Range(stws.Cells(l + 1, colcount), stws.Cells(l + 28, colcount)).Font.Color = RGB(0, 0, 0)
        stws.Cells(l + 1, colcount).Interior.Color = RGB(217, 217, 217)
        stws.Cells(l + 15, colcount).Interior.Color = RGB(217, 217, 217)
        stws.Range(stws.Cells(29, 4), stws.Cells(67, 3 + ptco)).Font.Color = RGB(0, 0, 0)
        
        Do While l <= 13
            Select Case l
                Case 0 To 3
                    If ptnum <> oldptnum Then
                        If ptcolor2(ptnum - 1)(l, 1) = "dif" Then
                            If flag = False Then
                                stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 1, colcount).Font.Color = RGB(255, 255, 255)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 1, colcount).Font.Color = RGB(255, 255, 255)
                                
                            End If
                                    
                        End If
                        
                    Else
                        stws.Range(stws.Cells(2, colcount), stws.Cells(14, colcount)).Interior.Pattern = xlGray50
                        
                    End If
                        
                    If stcolor2(stnum - 1)(l, 1) = "dif" Then
                        If flag = False Then
                            stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                            stws.Cells(l + 15, colcount).Font.Color = RGB(255, 255, 255)
                            stws.Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                            stws.Cells(l + 15, colcount).Font.Color = RGB(255, 255, 255)
                                                    
                        End If
                            
                    End If
                    
                Case 4 To 13
                    If ptcolor2(ptnum - 1)(l, 0) = "ｽｷｯﾌﾟ" Then
                        If ptcolor2(ptnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 1, colcount).Interior.Color = RGB(255, 255, 0)
                            
                        Else
                            If ptnum <> oldptnum Then
                                If flag = False Then
                                    stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, colcount).Font.Color = RGB(255, 255, 0)
                                    stws.Tab.ColorIndex = 3
                                    flag = True
                                    
                                Else
                                    stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, colcount).Font.Color = RGB(255, 255, 0)
                                    
                                End If
                                
                            End If
                                        
                        End If
                    ElseIf ptcolor2(ptnum - 1)(l, 0) = "異常停止" Or ptcolor2(ptnum - 1)(l, 0) = "停止" Then
                        If ptcolor2(ptnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 1, colcount).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(l + 1, colcount).Font.Color = RGB(255, 255, 255)
                            
                        Else
                            If ptnum <> oldptnum Then
                                If flag = False Then
                                    stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, colcount).Font.Color = RGB(255, 0, 0)
                                    stws.Tab.ColorIndex = 3
                                    flag = True
                                Else
                                    stws.Cells(l + 1, colcount).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, colcount).Font.Color = RGB(255, 0, 0)
                                    
                                End If
                                
                            End If
                                    
                        End If
                        
                    End If
                    
                    If stcolor2(stnum - 1)(l, 0) = "ｽｷｯﾌﾟ" Then
                        If stcolor2(stnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 15, colcount).Interior.Color = RGB(255, 255, 0)
                        
                        Else
                            If flag = False Then
                                stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, colcount).Font.Color = RGB(255, 255, 0)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, colcount).Font.Color = RGB(255, 255, 0)
                                
                            End If
                                
                        End If
                        
                    ElseIf stcolor2(stnum - 1)(l, 0) = "異常停止" Or stcolor2(stnum - 1)(l, 0) = "停止" Then
                        If stcolor2(stnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 15, colcount).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(l + 15, colcount).Font.Color = RGB(255, 255, 255)
                            
                        Else
                            If flag = False Then
                                stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, colcount).Font.Color = RGB(255, 0, 0)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 15, colcount).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, colcount).Font.Color = RGB(255, 0, 0)
                                
                            End If
                        End If
                        
                    End If
                            
            End Select
            
            l = l + 1
        Loop
        
    Else
        stws.Range(stws.Cells(l + 1, 8), stws.Cells(l + 28, 8)).Font.Color = RGB(0, 0, 0)
        stws.Cells(l + 1, 8).Interior.Color = RGB(217, 217, 217)
        stws.Cells(l + 15, 8).Interior.Color = RGB(217, 217, 217)
        stws.Range(stws.Cells(29, 4), stws.Cells(67, 3 + ptco)).Font.Color = RGB(0, 0, 0)

        Do While l <= 13
            Select Case l
                Case 0 To 3
                    If ptnum <> oldptnum Then
                        If ptcolor2(ptnum - 1)(l, 1) = "dif" Then
                            If flag = False Then
                                stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 1, 8).Font.Color = RGB(255, 255, 255)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 1, 8).Font.Color = RGB(255, 255, 255)
                                
                            End If
                                    
                        End If
                        
                    Else
                        stws.Range(stws.Cells(2, 8), stws.Cells(14, 8)).Interior.Pattern = xlGray50
                        
                    End If
                        
                    If stcolor2(stnum - 1)(l, 1) = "dif" Then
                        If flag = False Then
                            stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                            stws.Cells(l + 15, 8).Font.Color = RGB(255, 255, 255)
                            stws.Tab.ColorIndex = 3
                            flag = True
                            
                        Else
                            stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                            stws.Cells(l + 15, 8).Font.Color = RGB(255, 255, 255)
                                                    
                        End If
                            
                    End If
                    
                Case 4 To 13
                    If ptcolor2(ptnum - 1)(l, 0) = "ｽｷｯﾌﾟ" Then
                        If ptcolor2(ptnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 1, 8).Interior.Color = RGB(255, 255, 0)
                            
                        Else
                            If ptnum <> oldptnum Then
                                If flag = False Then
                                    stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, 8).Font.Color = RGB(255, 255, 0)
                                    stws.Tab.ColorIndex = 3
                                    flag = True
                                    
                                Else
                                    stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, 8).Font.Color = RGB(255, 255, 0)
                                    
                                End If
                                
                            End If
                                        
                        End If
                    ElseIf ptcolor2(ptnum - 1)(l, 0) = "異常停止" Or ptcolor2(ptnum - 1)(l, 0) = "停止" Then
                        If ptcolor2(ptnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 1, 8).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(l + 1, 8).Font.Color = RGB(255, 255, 255)
                            
                        Else
                            If ptnum <> oldptnum Then
                                If flag = False Then
                                    stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, 8).Font.Color = RGB(255, 0, 0)
                                    stws.Tab.ColorIndex = 3
                                    flag = True
                                Else
                                    stws.Cells(l + 1, 8).Interior.Color = RGB(48, 84, 150)
                                    stws.Cells(l + 1, 8).Font.Color = RGB(255, 0, 0)
                                    
                                End If
                                
                            End If
                                    
                        End If
                        
                    End If
                    
                    If stcolor2(stnum - 1)(l, 0) = "ｽｷｯﾌﾟ" Then
                        If stcolor2(stnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 15, 8).Interior.Color = RGB(255, 255, 0)
                        
                        Else
                            If flag = False Then
                                stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, 8).Font.Color = RGB(255, 255, 0)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, 8).Font.Color = RGB(255, 255, 0)
                                
                            End If
                                
                        End If
                        
                    ElseIf stcolor2(stnum - 1)(l, 0) = "異常停止" Or stcolor2(stnum - 1)(l, 0) = "停止" Then
                        If stcolor2(stnum - 1)(l, 1) <> "dif" Then
                            stws.Cells(l + 15, 8).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(l + 15, 8).Font.Color = RGB(255, 255, 255)
                            
                        Else
                            If flag = False Then
                                stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, 8).Font.Color = RGB(255, 0, 0)
                                stws.Tab.ColorIndex = 3
                                flag = True
                                
                            Else
                                stws.Cells(l + 15, 8).Interior.Color = RGB(48, 84, 150)
                                stws.Cells(l + 15, 8).Font.Color = RGB(255, 0, 0)
                                
                            End If
                        End If
                        
                    End If
                            
            End Select
            
            l = l + 1
        Loop


    End If
    
    If stcount <> 0 Then
        l = 0
        flag = False
        Do While l <= stcount - 1
            If flag = False Then
                If ptstreuse(l, 1) = ptstreuse(stcount, 1) And ptstreuse(l, 0) <> ptstreuse(stcount, 0) Then
                    stws.Cells(1, 2) = ptstreuse(l, 0) & "_reuse"
                    stws.Cells(1, 2).Interior.Color = RGB(48, 84, 150)
                    flag = True
                    
                End If
                
            End If
                
            l = l + 1
            
        Loop
        
        l = 0
        flag = False
        Do While l <= stcount - 1
            If flag = False Then
                If ptstreuse(l, 3) = ptstreuse(stcount, 3) Then
                    stws.Cells(15, 2) = ptstreuse(l, 0) & "-" & ptstreuse(l, 2) & "_reuse"
                    stws.Cells(15, 2).Interior.Color = RGB(48, 84, 150)
                    ptstreuse(stcount, 4) = ptstreuse(l, 0) & "-" & ptstreuse(l, 2) & "_reuse"
                    flag = True
                End If
                
            End If
            l = l + 1
            
        Loop
        
    End If
    
    stcount = stcount + 1
    ReDim modeinfo(38, ptco - 1)
    ReDim modeoldinfo(38, ptco - 1)
    modecount = 1
    
    If UBound(all.info(i)) >= 10 Then
    
        Do While modecount <= ptco
            Select Case all.info(i)(j + modecount + 1, col)
                Case "定電流充電"
                    If modecount < 10 Then
                        Call ccc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call ccc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                        
                Case "定電力充電"
                    If modecount < 10 Then
                        Call cpc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cpc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                                
                Case "定電流･定電圧充電"
                    If modecount < 10 Then
                        Call cccvc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cccvc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                
                Case "定電流放電"
                    If modecount < 10 Then
                        Call ccd3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call ccd2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                
                Case "定電力放電"
                    If modecount < 10 Then
                        Call cpd3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cpd2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                
                Case "休止2"
                    If modecount < 10 Then
                        Call dcrest3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call dcrest2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
                    
                Case "休止"
                    If modecount < 10 Then
                        Call rest3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call rest2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電流ﾃﾞｰﾀ充放電"
                    If modecount < 10 Then
                        Call datacdc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call datacdc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電力ﾃﾞｰﾀ充放電"
                    If modecount < 10 Then
                        Call datacdp3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call datacdp2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電流･定電圧放電"
                    If modecount < 10 Then
                        Call cccvd3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cccvd2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電力･電流放電"
                    If modecount < 10 Then
                        Call cpccd3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cpccd2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電力･電圧放電"
                    If modecount < 10 Then
                        Call cpcvd3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cpcvd2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電流･電力充電"
                    If modecount < 10 Then
                        Call cccpc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cccpc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
                Case "定電力･電圧充電"
                    If modecount < 10 Then
                        Call cpcvc3(modeinfo, j, i, modecount, modeoldinfo, col)
                    Else
                        Call cpcvc2(modeinfo, j, i, modecount, modeoldinfo, col)
                        
                    End If
    
            End Select
            
            modecount = modecount + 1
            
        Loop
        
        ReDim modeformat(38, ptco + 3)
        j = 0
        Do While j <= ptco + 3
            k = 0
            Do While k <= 38
                modeformat(k, j) = modeformat2(k, 0)
                
                k = k + 1
                
            Loop
            
            j = j + 1
            
        Loop
                
        stws.Range(stws.Cells(29, 4), stws.Cells(67, ptco + 3)).NumberFormat = modeformat
        stws.Range(stws.Cells(29, 4), stws.Cells(67, ptco + 3)).HorizontalAlignment = xlCenter
        stws.Range(stws.Cells(29, 4), stws.Cells(67, ptco + 3)) = modeinfo
        
    End If
        
    k = 0
    
    Dim Interiorcolor As String
    flag = False
    
    Do While k <= ptco - 1
        j = 0
        Do While j <= 38
            If modeoldinfo(j, k) = "dif" Then
                If j = 1 Then
                    If flag = False Then
                        Do While j <= 38
                            Interiorcolor = stws.Cells(j + 29, k + 4).Interior.Color
                            stws.Cells(j + 29, k + 4).Font.Color = Interiorcolor
                            stws.Cells(j + 29, k + 4).Interior.Color = RGB(48, 84, 150)
                            
                            j = j + 1
                            
                        Loop
                        
                        stws.Tab.ColorIndex = 3
                        flag = True
                            
                    Else
                        Do While j <= 38
                            Interiorcolor = stws.Cells(j + 29, k + 4).Interior.Color
                            stws.Cells(j + 29, k + 4).Font.Color = Interiorcolor
                            stws.Cells(j + 29, k + 4).Interior.Color = RGB(48, 84, 150)
                            
                            j = j + 1
                            
                        Loop

                        Exit Do
                    End If
                    
                Else
                    If flag = False Then
                        Interiorcolor = stws.Cells(j + 29, k + 4).Interior.Color
                        stws.Cells(j + 29, k + 4).Font.Color = Interiorcolor
                        stws.Cells(j + 29, k + 4).Interior.Color = RGB(48, 84, 150)
                        stws.Tab.ColorIndex = 3
                        flag = True
                        
                    Else
                        Interiorcolor = stws.Cells(j + 29, k + 4).Interior.Color
                        stws.Cells(j + 29, k + 4).Font.Color = Interiorcolor
                        stws.Cells(j + 29, k + 4).Interior.Color = RGB(48, 84, 150)
                        
                    End If
                    
                End If
            End If
            
            j = j + 1
            
        Loop
        
        k = k + 1
        
    Loop

End Sub

Sub ccc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False

    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電流充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, modecount - 1) = modecount
    modeinfo(1, modecount - 1) = "定電流充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 255, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
    
    k = 1
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                                            
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If

                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                                
                    
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                    
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 3) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If

            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
        
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
            
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電力充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 4
                If all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                
                            End If
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cccvc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電流・電圧充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電圧充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 102, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub ccd2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電流放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                    
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpd2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電力放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 4
                If all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub dcrest2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "切断休止"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "切断休止"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                End Select
    
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub rest2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "休止"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "休止"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "休止電圧上限(値)"
                        rwnum = 21
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "休止電圧下限(値)"
                        rwnum = 22
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
            
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub datacdc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "ﾃﾞｰﾀ充放電電流"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "ﾃﾞｰﾀ充放電電流"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "ﾃﾞｰﾀ充放電"
                rwnum = 5
                Select Case all.info(i)(j + 1, k)
                    Case "ﾌｧｲﾙ"
                        Dim csv As String
                        Dim csvco As Integer
                        Dim csvold As String
                        Dim csvcoold As Integer
                        
                        csvco = InStrRev(all.info(i)(j + modecount + 1, k), "\")
                        csv = Mid(all.info(i)(j + modecount + 1, k), csvco + 1)
                        csvcoold = InStrRev(all.oldinfo(i)(j + modecount + 1, k), "\")
                        csvold = Mid(all.oldinfo(i)(j + modecount + 1, k), csvco + 1)

                        
                        modeinfo(rwnum, (modecount - 1)) = csv
                        If csv <> csvold Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = csv
                                diflist(difcount, 6) = csvold
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    Case "ﾃﾞｰﾀ周期"
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    
                    Case "充電設定電圧"
                        modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                
                    Case "放電設定電圧"
                        modeinfo(rwnum + 3, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 3, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "電圧上限(値)"
                        rwnum = 26
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電圧下限(値)"
                        rwnum = 27
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力上限(値)"
                        rwnum = 29
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
                    
                    
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                
            Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub datacdp2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "ﾃﾞｰﾀ充放電電力"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "ﾃﾞｰﾀ充放電電力"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(102, 102, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "ﾃﾞｰﾀ充放電"
                rwnum = 5
                Select Case all.info(i)(j + 1, k)
                    Case "ﾌｧｲﾙ"
                        Dim csv As String
                        Dim csvco As Integer
                        Dim csvold As String
                        Dim csvcoold As Integer
                        
                        csvco = InStrRev(all.info(i)(j + modecount + 1, k), "\")
                        csv = Mid(all.info(i)(j + modecount + 1, k), csvco + 1)
                        csvcoold = InStrRev(all.oldinfo(i)(j + modecount + 1, k), "\")
                        csvold = Mid(all.oldinfo(i)(j + modecount + 1, k), csvco + 1)
                        
                        modeinfo(rwnum, (modecount - 1)) = csv
                        If csv <> csvold Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = csv
                                diflist(difcount, 6) = csvold
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "ﾃﾞｰﾀ周期"
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    
                    Case "充電設定電圧"
                        modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                
                    Case "放電設定電圧"
                        modeinfo(rwnum + 3, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 3, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "電圧上限(値)"
                        rwnum = 26
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電圧下限(値)"
                        rwnum = 27
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電流上限(値)"
                        rwnum = 28
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
                    
                    
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                
            Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cccvd2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電流・電圧放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電圧放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(128, 0, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpccd2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電力・電流放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電流放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cpcvd2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電力・電圧放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電圧放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                            End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cccpc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電流・電力充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電力充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cpcvc2(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & modecount & "_" & "定電力・電圧充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電圧充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub ccc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False

    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電流充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, modecount - 1) = modecount
    modeinfo(1, modecount - 1) = "定電流充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 255, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
    
    k = 1
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                                            
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If

                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                                
                    
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                    
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 3) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If

            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
        
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電力充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 4
                If all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                
                            End If
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cccvc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電流・電圧充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電圧充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 102, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub ccd3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電流放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                    
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpd3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電力放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 4
                If all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                End If
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub dcrest3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "切断休止"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "切断休止"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                End Select
    
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub rest3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "休止"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "休止"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "休止電圧上限(値)"
                        rwnum = 21
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "休止電圧下限(値)"
                        rwnum = 22
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
            
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub datacdc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "ﾃﾞｰﾀ充放電電流"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "ﾃﾞｰﾀ充放電電流"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(0, 0, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "ﾃﾞｰﾀ充放電"
                rwnum = 5
                Select Case all.info(i)(j + 1, k)
                    Case "ﾌｧｲﾙ"
                        Dim csv As String
                        Dim csvco As Integer
                        Dim csvold As String
                        Dim csvcoold As Integer
                        
                        csvco = InStrRev(all.info(i)(j + modecount + 1, k), "\")
                        csv = Mid(all.info(i)(j + modecount + 1, k), csvco + 1)
                        csvcoold = InStrRev(all.oldinfo(i)(j + modecount + 1, k), "\")
                        csvold = Mid(all.oldinfo(i)(j + modecount + 1, k), csvco + 1)

                        
                        modeinfo(rwnum, (modecount - 1)) = csv
                        If csv <> csvold Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = csv
                                diflist(difcount, 6) = csvold
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    Case "ﾃﾞｰﾀ周期"
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    
                    Case "充電設定電圧"
                        modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                
                    Case "放電設定電圧"
                        modeinfo(rwnum + 3, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 3, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "電圧上限(値)"
                        rwnum = 26
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電圧下限(値)"
                        rwnum = 27
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力上限(値)"
                        rwnum = 29
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
                    
                    
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                
            Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub datacdp3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "ﾃﾞｰﾀ充放電電力"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "ﾃﾞｰﾀ充放電電力"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(102, 102, 255)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "ﾃﾞｰﾀ充放電"
                rwnum = 5
                Select Case all.info(i)(j + 1, k)
                    Case "ﾌｧｲﾙ"
                        Dim csv As String
                        Dim csvco As Integer
                        Dim csvold As String
                        Dim csvcoold As Integer
                        
                        csvco = InStrRev(all.info(i)(j + modecount + 1, k), "\")
                        csv = Mid(all.info(i)(j + modecount + 1, k), csvco + 1)
                        csvcoold = InStrRev(all.oldinfo(i)(j + modecount + 1, k), "\")
                        csvold = Mid(all.oldinfo(i)(j + modecount + 1, k), csvco + 1)
                        
                        modeinfo(rwnum, (modecount - 1)) = csv
                        If csv <> csvold Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = csv
                                diflist(difcount, 6) = csvold
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "ﾃﾞｰﾀ周期"
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                    
                    Case "充電設定電圧"
                        modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                
                    Case "放電設定電圧"
                        modeinfo(rwnum + 3, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum + 3, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "電圧上限(値)"
                        rwnum = 26
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電圧下限(値)"
                        rwnum = 27
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電流上限(値)"
                        rwnum = 28
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
                    
                    
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                            
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                
            Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
    
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cccvd3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電流・電圧放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電圧放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(128, 0, 0)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
        
                        
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力(値)"
                        rwnum = 18
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                        
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
            
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                    
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                
                            
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub


Sub cpccd3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電力・電流放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電流放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cpcvd3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電力・電圧放電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電圧放電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 124, 128)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                            End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cccpc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電流・電力充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電流・電力充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電流" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    Case "電圧(値)"
                        rwnum = 16
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

Sub cpcvc3(modeinfo As Variant, j As Integer, i As Integer, modecount As Integer, modeoldinfo As Variant, col As Integer)
    Dim flag As Boolean
    Dim flag2 As Boolean
    Dim rw As Integer
    Dim rwnum As Integer
    Dim k As Integer
    Dim modeflag As Boolean
    
    modeflag = False
    
    If all.info(i)(j + modecount + 1, col) <> all.oldinfo(i)(j + modecount + 1, col) Then
        modeoldinfo(1, modecount - 1) = "dif"
        diflist(difcount, 0) = difcount + 1
        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & "定電力・電圧充電"
        diflist(difcount, 4) = all.info(i)(14, col)
        diflist(difcount, 5) = all.info(i)(j + modecount + 1, col)
        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, col)
        difcount = difcount + 1
        modeflag = True
    End If
    
    k = 1
    flag = False
    flag2 = False
    rw = 30
    
    modeinfo(0, (modecount - 1)) = modecount
    modeinfo(1, (modecount - 1)) = "定電力・電圧充電"
    stws.Cells(rw - 1, 4 + (modecount - 1)).Font.Color = RGB(153, 255, 51)
    stws.Cells(rw - 1, 4 + (modecount - 1)).Interior.Color = RGB(217, 217, 217)
        
    Do While k <= 63
        Select Case all.info(i)(j, k)
            Case "設定"
                rwnum = 3
                If all.info(i)(j + 1, k) = "電圧" Then
                    modeinfo(rwnum - 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum - 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                ElseIf all.info(i)(j + 1, k) = "電力" Then
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                            
                    End If
                    
                End If
                
                
                
            Case "恒温槽"
                Select Case all.info(i)(j + 1, k)
                    Case "設定温度"
                        rwnum = 9
                        If all.info(i)(j + modecount + 1, k) > 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        End If
                        
                        If all.oldinfo(i)(j + modecount + 1, k) > 500 Then
                            all.oldinfo(i)(j + modecount + 1, k) = "-"
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) And _
                            modeinfo(rwnum, (modecount - 1)) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ｽﾀｰﾄ条件"
                        rwnum = 10
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                    Case "ﾃﾞｨﾚｰ時間"
                        rwnum = 11
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                    
                End Select
                
            Case "記録"
                rwnum = 12
                modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                    If modeflag = False Then
                        diflist(difcount, 0) = difcount + 1
                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                        difcount = difcount + 1
                        
                    End If
                    
                End If
                
            Case "ループ"
                rwnum = 13
                If all.info(i)(j + 1, k) = "制御" Then
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    If all.info(i)(j + modecount + 1, k + 1) <> 1 Then
                        modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                        
                        If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k + 1)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k + 1)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k + 1)
                                difcount = difcount + 1
                                
                            End If

                        
                        End If
                    End If
                    
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If

                        
                    End If
                    
                End If
                
            Case "終止"
                Select Case all.info(i)(j + 1, k)
                    Case "時間(値)"
                        rwnum = 15
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k) / 3600 / 24
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                             
                        End If
                        
                    
                    Case "電流(値)"
                        rwnum = 17
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "容量(値)"
                        rwnum = 19
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "電力量(値)"
                        rwnum = 20
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                End Select
                    
            Case "%終止"
                If flag = False Then
                    rwnum = 23
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 1)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Or all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                            
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1 + 2, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                            
                    End If
                    flag = True
                
                End If
                
            Case "電圧変化量"
                If flag2 = False Then
                    flag2 = True
                    rwnum = 30
                    modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                    modeinfo(rwnum + 1, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 2)
                    modeinfo(rwnum + 2, (modecount - 1)) = all.info(i)(j + modecount + 1, k + 3)
                    If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                        modeoldinfo(rwnum, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 2) <> all.oldinfo(i)(j + modecount + 1, k + 2) Then
                        modeoldinfo(rwnum + 1, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 3) <> all.oldinfo(i)(j + modecount + 1, k + 3) Then
                        modeoldinfo(rwnum + 2, (modecount - 1)) = "dif"
                        If modeflag = False Then
                            diflist(difcount, 0) = difcount + 1
                            diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                            diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                            diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                            diflist(difcount, 4) = all.info(i)(j + 1, k)
                            diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                            diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                            difcount = difcount + 1
                            
                        End If
                        
                    End If
                    
                    If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                    ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                        stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                    End If
                    
                End If
        
            Case "ｾﾙ温度"
                Select Case all.info(i)(j + 1, k)
                    Case "上限(値)"
                        rwnum = 33
                        If all.info(i)(j + modecount + 1, k) = 500 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "下限(値)"
                        rwnum = 34
                        If all.info(i)(j + modecount + 1, k) = -50 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        ElseIf all.info(i)(j + modecount + 1, k) = -60 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                            
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            If all.info(i)(j + modecount + 1, k) <> -50 And all.info(i)(j + modecount + 1, k) <> -60 Then
                                modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                If modeflag = False Then
                                    diflist(difcount, 0) = difcount + 1
                                    diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                    diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                    diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                    diflist(difcount, 4) = all.info(i)(j + 1, k)
                                    diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                    diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                    difcount = difcount + 1
                                    
                                End If
                                            
                            Else
                                If all.oldinfo(i)(j + modecount + 1, k) <> -50 And all.oldinfo(i)(j + modecount + 1, k) <> -60 Then
                                    modeoldinfo(rwnum, (modecount - 1)) = "dif"
                                    If modeflag = False Then
                                        diflist(difcount, 0) = difcount + 1
                                        diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                        diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                        diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                        diflist(difcount, 4) = all.info(i)(j + 1, k)
                                        diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                        diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                        difcount = difcount + 1
                                        
                                    End If
                                    
                                    
                                End If
                            
                                
                            End If
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "判定遅延時間"
                        rwnum = 35
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt dX(値)"
                        rwnum = 36
                        modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Or all.info(i)(j + modecount + 1, k + 1) <> all.oldinfo(i)(j + modecount + 1, k + 1) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                        If all.info(i)(j + modecount + 1, k + 1) = "ｽｷｯﾌﾟ" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 255, 0)
                                
                        ElseIf all.info(i)(j + modecount + 1, k + 1) = "異常停止" Then
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Interior.Color = RGB(255, 0, 0)
                            stws.Cells(rw + rwnum - 1, 4 + (modecount - 1)).Font.Color = RGB(255, 255, 255)
                                
                        End If
                        
                    Case "dX/dt dt"
                        rwnum = 37
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                    Case "dX/dt用判定遅延時間"
                        rwnum = 38
                        If all.info(i)(j + modecount + 1, k) = 0.1 Then
                            modeinfo(rwnum, (modecount - 1)) = "-"
                        Else
                            modeinfo(rwnum, (modecount - 1)) = all.info(i)(j + modecount + 1, k)
                            
                        End If
                        
                        If all.info(i)(j + modecount + 1, k) <> all.oldinfo(i)(j + modecount + 1, k) Then
                            modeoldinfo(rwnum, (modecount - 1)) = "dif"
                            If modeflag = False Then
                                diflist(difcount, 0) = difcount + 1
                                diflist(difcount, 1) = ptstreuse(stcount - 1, 0) & "_" & ptstreuse(stcount - 1, 1)
                                diflist(difcount, 2) = ptstreuse(stcount - 1, 2) & "_" & ptstreuse(stcount - 1, 3)
                                diflist(difcount, 3) = "Mode" & "0" & modecount & "_" & modeinfo(1, modecount - 1)
                                diflist(difcount, 4) = all.info(i)(j + 1, k)
                                diflist(difcount, 5) = all.info(i)(j + modecount + 1, k)
                                diflist(difcount, 6) = all.oldinfo(i)(j + modecount + 1, k)
                                difcount = difcount + 1
                                
                            End If
                                
                        End If
                        
                End Select
        End Select
        
        k = k + 1
         
    Loop
                        
                        
End Sub

